import { createReducer } from '@reduxjs/toolkit'

const initialState = {
  connected: false,
  cars: []
  //"cars": [{"lapNumber":2,"sector":0,"lapTime":0,"position":14,"gridPosition":13,"sector1Time":0,"sector2Time":0,"lapDistance":500.95068,"currentLapTime":9.208532,"totalDistance":0,"lastLapTime":84.63261,"bestLapTime":84.63261,"bestLapSector1Time":40057,"bestLapSector2Time":20668,"bestLapSector3Time":23906,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":0},{"lapNumber":2,"sector":0,"lapTime":0,"position":3,"gridPosition":3,"sector1Time":0,"sector2Time":0,"lapDistance":808.10254,"currentLapTime":14.5634575,"totalDistance":0,"lastLapTime":79.28918,"bestLapTime":79.28918,"bestLapSector1Time":36983,"bestLapSector2Time":19411,"bestLapSector3Time":22893,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":1},{"lapNumber":2,"sector":0,"lapTime":0,"position":16,"gridPosition":15,"sector1Time":0,"sector2Time":0,"lapDistance":460.54785,"currentLapTime":8.541146,"totalDistance":0,"lastLapTime":85.31033,"bestLapTime":85.31033,"bestLapSector1Time":40764,"bestLapSector2Time":20540,"bestLapSector3Time":24006,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":2},{"lapNumber":2,"sector":0,"lapTime":0,"position":19,"gridPosition":19,"sector1Time":0,"sector2Time":0,"lapDistance":421.9048,"currentLapTime":7.5236254,"totalDistance":0,"lastLapTime":86.317215,"bestLapTime":86.317215,"bestLapSector1Time":41139,"bestLapSector2Time":20928,"bestLapSector3Time":24248,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":3},{"lapNumber":2,"sector":0,"lapTime":0,"position":13,"gridPosition":14,"sector1Time":0,"sector2Time":0,"lapDistance":520.7051,"currentLapTime":9.458761,"totalDistance":0,"lastLapTime":84.38685,"bestLapTime":84.38685,"bestLapSector1Time":40041,"bestLapSector2Time":20686,"bestLapSector3Time":23658,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":4},{"lapNumber":2,"sector":0,"lapTime":0,"position":6,"gridPosition":6,"sector1Time":0,"sector2Time":0,"lapDistance":751.0054,"currentLapTime":13.228787,"totalDistance":0,"lastLapTime":80.608376,"bestLapTime":80.608376,"bestLapSector1Time":37913,"bestLapSector2Time":19885,"bestLapSector3Time":22809,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":5},{"lapNumber":2,"sector":0,"lapTime":0,"position":11,"gridPosition":10,"sector1Time":0,"sector2Time":0,"lapDistance":577.8174,"currentLapTime":10.5929,"totalDistance":0,"lastLapTime":83.2599,"bestLapTime":83.2599,"bestLapSector1Time":39495,"bestLapSector2Time":20215,"bestLapSector3Time":23549,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":6},{"lapNumber":2,"sector":0,"lapTime":0,"position":2,"gridPosition":1,"sector1Time":0,"sector2Time":0,"lapDistance":830.6616,"currentLapTime":15.213766,"totalDistance":0,"lastLapTime":78.625244,"bestLapTime":78.625244,"bestLapSector1Time":36552,"bestLapSector2Time":19261,"bestLapSector3Time":22811,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":7},{"lapNumber":2,"sector":0,"lapTime":0,"position":12,"gridPosition":11,"sector1Time":0,"sector2Time":0,"lapDistance":560.2114,"currentLapTime":10.409497,"totalDistance":0,"lastLapTime":83.4311,"bestLapTime":83.4311,"bestLapSector1Time":39690,"bestLapSector2Time":20230,"bestLapSector3Time":23510,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":8},{"lapNumber":2,"sector":0,"lapTime":0,"position":9,"gridPosition":9,"sector1Time":0,"sector2Time":0,"lapDistance":623.26855,"currentLapTime":11.343932,"totalDistance":0,"lastLapTime":82.50677,"bestLapTime":82.50677,"bestLapSector1Time":39040,"bestLapSector2Time":20129,"bestLapSector3Time":23337,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":9},{"lapNumber":2,"sector":0,"lapTime":0,"position":17,"gridPosition":16,"sector1Time":0,"sector2Time":0,"lapDistance":450.39062,"currentLapTime":8.441146,"totalDistance":0,"lastLapTime":85.40277,"bestLapTime":85.40277,"bestLapSector1Time":41061,"bestLapSector2Time":20589,"bestLapSector3Time":23751,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":10},{"lapNumber":2,"sector":0,"lapTime":0,"position":18,"gridPosition":20,"sector1Time":0,"sector2Time":0,"lapDistance":437.26855,"currentLapTime":7.92393,"totalDistance":0,"lastLapTime":85.927956,"bestLapTime":85.927956,"bestLapSector1Time":41274,"bestLapSector2Time":20767,"bestLapSector3Time":23886,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":11},{"lapNumber":2,"sector":0,"lapTime":0,"position":4,"gridPosition":4,"sector1Time":0,"sector2Time":0,"lapDistance":796.1831,"currentLapTime":14.329927,"totalDistance":0,"lastLapTime":79.52104,"bestLapTime":79.52104,"bestLapSector1Time":37117,"bestLapSector2Time":19509,"bestLapSector3Time":22894,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":12},{"lapNumber":2,"sector":0,"lapTime":0,"position":5,"gridPosition":5,"sector1Time":0,"sector2Time":0,"lapDistance":773.6875,"currentLapTime":13.645971,"totalDistance":0,"lastLapTime":80.20287,"bestLapTime":80.20287,"bestLapSector1Time":37905,"bestLapSector2Time":19533,"bestLapSector3Time":22763,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":13},{"lapNumber":2,"sector":0,"lapTime":0,"position":8,"gridPosition":8,"sector1Time":0,"sector2Time":0,"lapDistance":678.23096,"currentLapTime":12.011178,"totalDistance":0,"lastLapTime":81.82521,"bestLapTime":81.82521,"bestLapSector1Time":38600,"bestLapSector2Time":19980,"bestLapSector3Time":23243,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":14},{"lapNumber":2,"sector":0,"lapTime":0,"position":10,"gridPosition":12,"sector1Time":0,"sector2Time":0,"lapDistance":613.18604,"currentLapTime":11.19374,"totalDistance":0,"lastLapTime":82.653046,"bestLapTime":82.653046,"bestLapSector1Time":39185,"bestLapSector2Time":20073,"bestLapSector3Time":23394,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":15},{"lapNumber":2,"sector":0,"lapTime":0,"position":7,"gridPosition":7,"sector1Time":0,"sector2Time":0,"lapDistance":697.4297,"currentLapTime":12.344817,"totalDistance":0,"lastLapTime":81.5048,"bestLapTime":81.5048,"bestLapSector1Time":38222,"bestLapSector2Time":20032,"bestLapSector3Time":23249,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":16},{"lapNumber":2,"sector":0,"lapTime":0,"position":15,"gridPosition":17,"sector1Time":0,"sector2Time":0,"lapDistance":477.46436,"currentLapTime":8.8415785,"totalDistance":0,"lastLapTime":85.0111,"bestLapTime":85.0111,"bestLapSector1Time":40476,"bestLapSector2Time":20515,"bestLapSector3Time":24019,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":17},{"lapNumber":2,"sector":0,"lapTime":0,"position":20,"gridPosition":18,"sector1Time":0,"sector2Time":0,"lapDistance":410.97852,"currentLapTime":7.32347,"totalDistance":0,"lastLapTime":86.517296,"bestLapTime":86.517296,"bestLapSector1Time":41422,"bestLapSector2Time":21028,"bestLapSector3Time":24065,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":18},{"lapNumber":2,"sector":0,"lapTime":0,"position":1,"gridPosition":2,"sector1Time":0,"sector2Time":0,"lapDistance":871.2886,"currentLapTime":16.315046,"totalDistance":0,"lastLapTime":77.5328,"bestLapTime":77.5328,"bestLapSector1Time":35831,"bestLapSector2Time":19137,"bestLapSector3Time":22563,"bestSector1Time":0,"bestSector2Time":0,"bestSector3Time":0,"bestSector1Lap":0,"bestSector2Lap":0,"bestSector3Lap":0,"type":"lap","frameId":1140,"carId":19}],
  //"car": {"speed":132,"gear":2,"throttle":0.69723046,"break":0,"fl":{"innerTemperature":101,"surfaceTemperature":98,"presure":23.549026},"fr":{"innerTemperature":101,"surfaceTemperature":98,"presure":23.549026},"rl":{"innerTemperature":101,"surfaceTemperature":98,"presure":23.549026},"rr":{"innerTemperature":101,"surfaceTemperature":98,"presure":23.549026},"type":"telemetry","frameId":1150,"carId":19}

}

const SessionReducer = createReducer(initialState, (builder) => {
  builder.addCase('REDUX_WEBSOCKET::OPEN', (state, action) => {
    console.log('Connection Opened');
    state.connected = true;
  });
  builder.addCase('REDUX_WEBSOCKET::CLOSED', (state, action) => {
    console.log('Connection Closed');
    state.connected = false;
  });
  builder.addCase('REDUX_WEBSOCKET::MESSAGE', (state, action) => {
    const data = JSON.parse(action.payload.message); 
    if (data.type === 'lap') {
      state.cars[data.carId] = data;
    }
    if (data.type === 'telemetry') {
      state.car = data
    }
  });
})

export default SessionReducer;